(window.webpackJsonp=window.webpackJsonp||[]).push([[231],{681:function(s,a,t){"use strict";t.r(a);var e=t(10),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker"}},[s._v("#")]),s._v(" Docker")]),s._v(" "),t("h2",{attrs:{id:"docker-是什么"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-是什么"}},[s._v("#")]),s._v(" Docker 是什么?")]),s._v(" "),t("p",[s._v("Docker是一个开源的应用容器引擎，基于Go语言并遵从Apache2.0协议，Docker可以让开发者打包以及依赖包到一个轻量级、可移植的容器中，容器完全使用沙箱机制，相互之间不会有任何接口。")]),s._v(" "),t("h2",{attrs:{id:"docker-能干什么"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-能干什么"}},[s._v("#")]),s._v(" Docker 能干什么?")]),s._v(" "),t("p",[s._v("Web应用的自动化打包和发布\n自动化测试和持续集成，部署\n在服务器环境中部署和调整数据库以及其他后台应用\n从头编译或扩展现有的云开发平台来搭建自己的PaaS环境")]),s._v(" "),t("h2",{attrs:{id:"docker-怎么用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-怎么用"}},[s._v("#")]),s._v(" Docker 怎么用?")]),s._v(" "),t("h3",{attrs:{id:"安装docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装docker"}},[s._v("#")]),s._v(" 安装docker")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Ubuntu安装")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker.io\n")])])]),t("h3",{attrs:{id:"hello-wrold"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#hello-wrold"}},[s._v("#")]),s._v(" Hello Wrold")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Docker允许你在容器内运行应用程序 使用docker run 命令 ")]),s._v("\ndocker run ubuntu:18.04 /bin/echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Hello World"')]),s._v("\n")])])]),t("h3",{attrs:{id:"获取镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#获取镜像"}},[s._v("#")]),s._v(" 获取镜像")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("docker pull ubuntu\n")])])]),t("h3",{attrs:{id:"运行交互式的容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#运行交互式的容器"}},[s._v("#")]),s._v(" 运行交互式的容器")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -i 允许对容器类的标准输入进行交互 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -t 在新容器内指定一个终端 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -d 让容器在后台保持运行")]),s._v("\ndocker run -i -t ubuntu:18.04 /bin/bash\ndocker run -d ubuntu:18.04 /bin/bash\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 直接退出")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 退出容器但保持运行(常用)")]),s._v("\nCTRL+P CTRL+Q\n")])])]),t("h3",{attrs:{id:"查看"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看"}},[s._v("#")]),s._v(" 查看")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看活动的docker")]),s._v("\ndocker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看所有的docker")]),s._v("\ndocker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -a \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看详细参数")]),s._v("\ndocker stats\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出详情")]),s._v("\nCONTAINER ID IAMGE COMMAND CREATED STATUS PORTS NAMES\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看容器类的标准输出")]),s._v("\ndocker logs container-id/container-name\n")])])]),t("h3",{attrs:{id:"增删"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#增删"}},[s._v("#")]),s._v(" 增删")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动一个docker-container")]),s._v("\ndocker start dcontainer-id\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入一个后台docker-container")]),s._v("\ndocker attach container-id\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入一个后台docker-container，退出不会导致容器停止")]),s._v("\ndocker "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" container-id \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止")]),s._v("\ndocker stop container-id\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除某个docker")]),s._v("\ndocker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" container-id\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除所有已经停止的容器")]),s._v("\ndocker container prune\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看docker镜像")]),s._v("\ndocker image "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除镜像")]),s._v("\ndocker rmi image-id\n")])])]),t("h3",{attrs:{id:"命名"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#命名"}},[s._v("#")]),s._v(" 命名")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 给docker命名")]),s._v("\ndocker run --name docker-name  -d container-name:version\ndocker run --name "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" -d ubuntu:18.04\n")])])]),t("h3",{attrs:{id:"映射"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#映射"}},[s._v("#")]),s._v(" 映射")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker端口映射")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -p 本地端口:容器端口")]),s._v("\ndocer run -p local-port:docker-port\ndocker run --name docker-name  -d -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v(":80 nginx\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 部署服务，进入项目根目录，然后执行命令")]),s._v("\ndocker run --name docker-name -d -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v(":80 -v "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("pwd")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(":/usr/share/nginx/html nginx\n")])])]),t("h3",{attrs:{id:"导入和导出"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#导入和导出"}},[s._v("#")]),s._v(" 导入和导出")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 导出容器快照到tar文件")]),s._v("\ndocker "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" container-id "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" ubuntu.tar\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 导入快照为镜像")]),s._v("\ndocker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("import")]),s._v(" \n")])])]),t("h2",{attrs:{id:"dockerfile"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile"}},[s._v("#")]),s._v(" Dockerfile")]),s._v(" "),t("p",[s._v("dockerfile")]),s._v(" "),t("div",{staticClass:"language-dockerfile extra-class"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" nginx\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" echo "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'这是一个本地构建的nginx镜像'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v(" /usr/share/nginx/html/index.html\n")])])]),t("p",[s._v("FROM：定制的镜像都是基于 FROM 的镜像，这里的 nginx 就是定制需要的基础镜像。后续的操作都是基于 nginx。\nRUN：用于执行后面跟着的命令行命令。有以下俩种格式：")]),s._v(" "),t("div",{staticClass:"language-dockerfile extra-class"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" <命令行命令"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# <命令行命令> 等同于，在终端操作的 shell 命令。")]),s._v("\n")])])]),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("docker build -t nginx:local .\n")])])]),t("p",[s._v("注意：Dockerfile 的指令每执行一次都会在 docker 上新建一层。所以过多无意义的层，会造成镜像膨胀过大。例如：")]),s._v(" "),t("div",{staticClass:"language-dockerfile extra-class"},[t("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" centos\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" yum install wget\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" wget "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("O redis.tar.gz "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://download.redis.io/releases/redis-5.0.3.tar.gz"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" tar "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("xvf redis.tar.gz\n以上执行会创建 3 层镜像。可简化为以下格式：\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" centos\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" yum install wget \\\n    && wget "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("O redis.tar.gz "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://download.redis.io/releases/redis-5.0.3.tar.gz"')]),s._v(" \\\n    && tar "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("xvf redis.tar.gz\n")])])]),t("h3",{attrs:{id:"创建镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建镜像"}},[s._v("#")]),s._v(" 创建镜像")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -a author")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -c 使用Dockerfile指令来创建镜像")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -m 提交说明")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -p 提交时将容器暂停")]),s._v("\ndocker commit -a guasszhou -m "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"hello docker"')]),s._v(" container repository:tag\n")])])]),t("p",[s._v("###　Docker hub")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 登录")]),s._v("\ndocker login\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 登出")]),s._v("\ndocker "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("logout")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 搜索")]),s._v("\ndocker search ubuntu\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 拉去")]),s._v("\ndocker pull ubuntu\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 推送")]),s._v("\ndocker push username/ubuntu:18.04\n")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);